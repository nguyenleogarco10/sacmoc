<!DOCTYPE html>
<html lang="vi" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sắc Mộc - Vẻ Đẹp Có Trách Nhiệm</title>

    <!-- SEO Meta Tags -->
    <meta name="description" content="Sắc Mộc - Thương hiệu mỹ phẩm Việt cam kết về vẻ đẹp an toàn, tinh khiết và bền vững. Khám phá son môi tự nhiên không hóa chất độc hại.">
    <meta property="og:title" content="Sắc Mộc - Vẻ Đẹp Có Trách Nhiệm">
    <meta property="og:description" content="Sắc Mộc - Thương hiệu mỹ phẩm Việt cam kết về vẻ đẹp an toàn, tinh khiết và bền vững. Khám khám son môi tự nhiên không hóa chất độc hại.">
    <meta property="og:image" content="https://placehold.co/1200x630/5D7A4D/FFFFFF?text=Sac+Moc+Beauty"> <!-- Placeholder, replace with actual image URL -->
    <meta property="og:url" content="https://www.sacmoc.vn"> <!-- Replace with actual website URL -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Preload fonts for faster loading -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Merriweather+Sans:wght@700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'\">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'\">
    <noscript>
        <link href="https://fonts.googleapis.com/css2?family=Merriweather+Sans:wght@700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    </noscript>

    <!-- Preload critical scripts -->
    <link rel="preload" href="https://cdn.tailwindcss.com" as="script">
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/chart.js" as="script">
    <!-- Removed TensorFlow.js preload links -->

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Removed TensorFlow.js script links -->

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Updated font to be more in harmony with the logo - 'Merriweather Sans' for headings and 'Open Sans' for body text -->
    <link href="https://fonts.googleapis.com/css2?family=Merriweather+Sans:wght@700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            /* Changed font-family to Open Sans for general text */
            font-family: 'Open Sans', sans-serif;
            /* Changed background-color to beige */
            background-color: #F5F5DC;
            color: #4A4A4A;
            /* Add padding-top to body to prevent content from hiding under fixed header */
            padding-top: 9rem; /* Equivalent to h-36 + some buffer, adjust if needed */
        }
        /* New custom class for headings to use Merriweather Sans */
        .font-heading {
            font-family: 'Merriweather Sans', sans-serif;
        }
        /* Updated brand colors to be closer to the logo's green/brown tones */
        .text-brand { color: #5D7A4D; } /* A darker, earthy green */
        .bg-brand { background-color: #5D7A4D; }
        .bg-brand-light { background-color: #A2B99C; } /* A lighter green */
        .bg-brand-superlight { background-color: #E6EDE4; } /* Very light green */
        .border-brand { border-color: #5D7A4D; }
        
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 400px;
            max-height: 50vh;
        }
        @media (max-width: 768px) {
            .chart-container {
                height: 500px;
                max-height: 70vh;
            }
        }
        .nav-link {
            transition: color 0.3s ease;
        }
        .nav-link:hover {
            color: #5D7A4D; /* Updated hover color */
        }
        .card-hover {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        
        /* New CSS for testimonial carousel structure */
        .testimonial-viewport {
            overflow: hidden; /* This creates the visible window for testimonials */
            position: relative;
            width: 100%;
            /* Removed scroll-snap-type as it conflicts with JS controlled sliding */
        }

        #testimonial-slider { 
            display: flex;
            transition: transform 0.5s ease-in-out; /* Apply transition to the element being transformed */
            flex-wrap: nowrap; /* Ensure items don't wrap to the next line */
            -webkit-overflow-scrolling: touch; /* For smooth scrolling on iOS */
            /* Width will be set dynamically by JS */
        }
        
        .testimonial-card {
            /* flex-shrink and flex-grow will be set by JS */
            /* width will be set dynamically by JS to ensure proper sizing */
            /* Removed flex-basis and media queries as JS will handle sizing */
        }
         /* PADDING is still relevant for inside the cards */
         .testimonial-card .bg-white {
            padding: 1.5rem; /* Equivalent to p-6 Tailwind class */
         }

        /* Removed VTO modal specific styles */

        /* Hero section background image blur and fade-in effect */
        .hero-background-image {
            filter: blur(8px); /* Initial blur */
            transition: filter 1s ease-out, transform 1s ease-out; /* Smooth transition for blur and zoom */
            transform: scale(1.05); /* Slightly zoomed in */
        }
        .hero-background-image.loaded {
            filter: blur(0); /* No blur after loading */
            transform: scale(1); /* Original scale */
        }

        /* Animation classes for scroll effects */
        .animate-on-scroll {
            opacity: 0;
            /* Default transform for slide-up and zoom-in */
            transform: translateY(20px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }

        /* Specific initial states if they differ from the default transform */
        .animate-on-scroll.zoom-in {
            transform: scale(0.95);
        }
        /* No specific transform for fade-in, it just uses opacity */

        /* The class that makes elements visible and resets transform */
        .animate-on-scroll.visible {
            opacity: 1;
            transform: translateY(0); /* Reset for slide-up and default */
        }
        .animate-on-scroll.zoom-in.visible {
            transform: scale(1); /* Reset for zoom-in */
        }
        /* No explicit fade-in.visible needed if it's just opacity */

        /* Styles for the video background */
        .video-background {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover; /* Ensures the video covers the entire area */
            z-index: -1; /* Puts the video behind other content */
        }

        /* Shopping Cart Styles */
        .cart-sidebar {
            position: fixed;
            top: 0;
            right: -100%; /* Initially hidden off-screen */
            width: 100%;
            max-width: 400px; /* Max width for desktop */
            height: 100%;
            background-color: #F5F5DC; /* Beige background */
            box-shadow: -2px 0 10px rgba(0, 0, 0, 0.1);
            transition: right 0.3s ease-in-out;
            z-index: 1000; /* High z-index to be on top */
            display: flex;
            flex-direction: column;
        }

        .cart-sidebar.open {
            right: 0; /* Slide in */
        }

        .cart-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 999;
            display: none; /* Hidden by default */
        }

        .cart-overlay.open {
            display: block; /* Show when cart is open */
        }

        /* For the cart badge */
        .cart-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: #EF4444; /* Red color */
            color: white;
            border-radius: 9999px; /* Fully rounded */
            padding: 2px 6px; /* Adjust padding for size */
            font-size: 0.75rem; /* Text size */
            font-weight: bold;
            min-width: 20px; /* Ensure it's a circle even with single digit */
            text-align: center;
        }

        /* Animation for product flying to cart */
        .fly-to-cart-animation {
            position: fixed;
            top: var(--start-y);
            left: var(--start-x);
            width: var(--size);
            height: var(--size);
            background-color: var(--color);
            border-radius: 50%; /* Make it round */
            opacity: 1;
            z-index: 1001; /* Above cart sidebar */
            transition: all 0.6s ease-in-out; /* Smooth transition for position and size */
            transform: scale(1);
        }

        .fly-to-cart-animation.animate {
            top: var(--end-y);
            left: var(--end-x);
            width: 20px; /* Smaller when flying to cart */
            height: 20px;
            opacity: 0.5;
            transform: scale(0.5);
        }

        /* CSS for the subtle pulse animation */
        @keyframes subtlePulse {
          0% { transform: scale(1); box-shadow: 0 0 0 rgba(93,122,77,0.2); }
          50% { transform: scale(1.02); box-shadow: 0 0 12px rgba(93,122,77,0.35); }
          100% { transform: scale(1); box-shadow: 0 0 0 rgba(93,122,77,0.2); }
        }
        .btn-pulse {
          animation: subtlePulse 2.8s ease-in-out infinite;
        }
    </style>
</head>
<body class="antialiased">

    <!-- Header section - Changed to 'fixed' -->
    <header id="header" class="bg-white/80 backdrop-blur-md fixed top-0 left-0 right-0 w-full z-50 shadow-sm" role="banner">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-36"> 
                <div class="flex-shrink-0 flex items-center">
                    <a href="#hero" class="flex items-center" aria-label="Trang chủ Sắc Mộc">
                        <img src="Logo.png" alt="Sắc Mộc Logo" class="h-32 w-auto"> 
                    </a>
                </div>
                <!-- Desktop Navigation and Cart Icon -->
                <div class="hidden md:flex items-center"> <!-- This div will contain both nav and desktop cart -->
                    <nav class="flex items-center space-x-8" role="navigation" aria-label="Điều hướng chính">
                        <a href="#philosophy" class="text-gray-600 nav-link font-medium" aria-label="Đi đến phần Triết Lý">Triết Lý</a>
                        <a href="#products" class="text-gray-600 nav-link font-medium" aria-label="Đi đến phần Sản Phẩm">Sản Phẩm</a>
                        <a href="#transparency" class="text-gray-600 nav-link font-medium" aria-label="Đi đến phần Minh Bạch">Minh Bạch</a>
                        <a href="#community" class="text-gray-600 nav-link font-medium" aria-label="Đi đến phần Cộng Đồng">Cộng Đồng</a>
                    </nav>
                    <div class="relative ml-8"> <!-- Added ml-8 for spacing between nav and cart -->
                        <button id="cart-icon-desktop" class="relative text-gray-600 hover:text-brand focus:outline-none p-2 rounded-full hover:bg-gray-100 transition-colors" aria-label="Mở giỏ hàng">
                            <!-- Updated Shopping Cart SVG icon -->
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8 text-brand">
                                <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/>
                                <path d="M3 6h18"/>
                                <path d="M16 10a4 4 0 0 1-8 0"/>
                            </svg>
                            <span id="cart-badge-desktop" class="cart-badge hidden">0</span>
                        </button>
                    </div>
                </div>
                <!-- Mobile Menu & Cart Icon -->
                <div class="md:hidden flex items-center space-x-4">
                    <button id="cart-icon-mobile" class="relative text-gray-600 hover:text-brand focus:outline-none p-2 rounded-full hover:bg-gray-100 transition-colors" aria-label="Mở giỏ hàng">
                        <!-- Updated Shopping Cart SVG icon -->
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-8 h-8 text-brand">
                            <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 0 0 0 2-2V6l-3-4Z"/>
                            <path d="M3 6h18"/>
                            <path d="M16 10a4 0 0 1-8 0"/>
                        </svg>
                        <span id="cart-badge-mobile" class="cart-badge hidden">0</span>
                    </button>
                    <button id="mobile-menu-button" class="text-gray-600 hover:text-brand focus:outline-none" aria-label="Mở menu di động">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16m-7 6h7" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <div id="mobile-menu" class="md:hidden hidden" role="navigation" aria-label="Menu di động">
            <nav class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#philosophy" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-brand hover:bg-gray-50" aria-label="Đi đến phần Triết Lý">Triết Lý</a>
                <a href="#products" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-brand hover:bg-gray-50" aria-label="Đi đến phần Sản Phẩm">Sản Phẩm</a>
                <a href="#transparency" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-brand hover:bg-gray-50" aria-label="Đi đến phần Minh Bạch">Minh Bạch</a>
                <a href="#community" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-brand hover:bg-gray-50" aria-label="Đi đến phần Cộng Đồng">Cộng Đồng</a>
            </nav>
        </div>
    </header>

    <main>
        <!-- Hero section - Dynamic background image with blur/fade -->
        <section id="hero" class="pt-16 h-screen flex items-center bg-cover bg-center relative overflow-hidden" role="region" aria-label="Giới thiệu Sắc Mộc">
            <!-- Video background -->
            <video autoplay loop muted playsinline class="video-background">
                <source src="Video.mp4" type="video/mp4">
                <!-- Add more source types if needed for broader browser support (e.g., .webm, .ogg) -->
                Your browser does not support the video tag.
            </video>
            <!-- Removed the transparent overlay div as per user request -->
            <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center animate-on-scroll visible"> <!-- Hero section is visible by default -->
                <!-- Increased font size for the main heading on the banner -->
                <!-- Added gradient text effect for the slogan -->
                <!-- Adjusted line-height to ensure diacritics are not cut off -->
                <h1 class="text-5xl md:text-7xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-[#5D7A4D] to-[#8CA786] tracking-tight font-heading leading-normal py-4">
                    Tự nhiên từ Sắc,<br>Mộc từ tâm
                </h1> <!-- Applied font-heading here -->
                <p class="mt-4 max-w-2xl mx-auto text-lg md:text-xl text-white" style="text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);">Sắc Mộc không chỉ là son môi. Đó là một lựa chọn an toàn cho bạn, tử tế với hành tinh và cam kết cho một vẻ đẹp minh bạch.</p>
                <div class="mt-8">
                    <a href="#philosophy" class="inline-block bg-brand text-white font-bold py-3 px-8 rounded-full shadow-lg hover:bg-opacity-90 transition-transform transform hover:scale-105" aria-label="Khám phá câu chuyện của Sắc Mộc">Khám Phám Câu Chuyện</a>
                </div>
            </div>
        </section>

        <section id="philosophy" class="py-20 bg-white" role="region" aria-label="Triết lý Sắc Mộc">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center animate-on-scroll slide-up">
                    <h2 class="text-3xl font-bold text-brand font-heading">Triết Lý Sắc Mộc</h2> <!-- Applied font-heading here -->
                    <p class="mt-4 max-w-3xl mx-auto text-lg text-gray-600">Chúng tôi ra đời để giải quyết những lo ngại về sức khỏe và môi trường trong ngành mỹ phẩm. Sắc Mộc là câu trả lời cho nhu cầu về một vẻ đẹp không chỉ rạng rỡ bên ngoài mà còn an tâm từ bên trong.</p>
                </div>
                <div class="mt-16 grid gap-10 md:grid-cols-2 lg:grid-cols-4">
                    <div class="text-center p-6 bg-brand-superlight rounded-xl card-hover animate-on-scroll slide-up" style="transition-delay: 0.1s;">
                        <div class="flex items-center justify-center h-16 w-16 rounded-full bg-brand-light mx-auto text-3xl">
                            <!-- SVG Icon for An Toàn & Tinh Khiết (Safe & Pure) - Leaf -->
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M17.32 5.09a.75.75 0 011.06 0L20 6.71l-1.68 1.68a.75.75 0 01-1.06 0L17.32 5.09zM12 21.35c-3.78-3.4-7.18-6.8-7.18-11.54 0-3.08 2.42-5.5 5.5-5.5 1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3c3.08 0 5.5 2.42 5.5 5.5 0 3.78-3.4 6.86-8.55 11.54L12 21.35zM9.5 7C7.57 7 6 8.57 6 10.5S7.57 14 9.5 14 13 12.43 13 10.5 11.43 7 9.5 7z"/>
                            </svg>
                        </div>
                        <h3 class="mt-5 text-xl font-semibold text-brand font-heading">An Toàn & Tinh Khiết</h3> <!-- Applied font-heading here -->
                        <p class="mt-2 text-gray-600">Công thức với hơn 95% thành phần tự nhiên, không chứa kim loại nặng, parabens hay hóa chất độc hại.</p>
                    </div>
                    <div class="text-center p-6 bg-brand-superlight rounded-xl card-hover animate-on-scroll slide-up" style="transition-delay: 0.2s;">
                        <div class="flex items-center justify-center h-16 w-16 rounded-full bg-brand-light mx-auto text-3xl">
                            <!-- SVG Icon for Bền Vững & Ý Thức (Sustainable & Conscious) - Globe -->
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.71-7-4.22-7-8.93 0-.31.02-.61.04-.92L11 4.07v15.86z"/>
                            </svg>
                        </div>
                        <h3 class="mt-5 text-xl font-semibold text-brand font-heading">Bền Vững & Ý Thức</h3> <!-- Applied font-heading here -->
                        <p class="mt-2 text-gray-600">Bao bì thân thiện môi trường, tái chế được và nguồn nguyên liệu khai thác có đạo đức.</p>
                    </div>
                    <div class="text-center p-6 bg-brand-superlight rounded-xl card-hover animate-on-scroll slide-up" style="transition-delay: 0.3s;">
                         <div class="flex items-center justify-center h-16 w-16 rounded-full bg-brand-light mx-auto text-3xl">
                            <!-- SVG Icon for Minh Bạch & Đạo Đức (Transparent & Ethical) - Heart -->
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                            </svg>
                        </div>
                        <h3 class="mt-5 text-xl font-semibold text-brand font-heading">Minh Bạch & Đạo Đức</h3> <!-- Applied font-heading here -->
                        <p class="mt-2 text-gray-600">Cam kết 100% không thử nghiệm trên động vật và công khai toàn bộ thành phần sản phẩm.</p>
                    </div>
                     <div class="text-center p-6 bg-brand-superlight rounded-xl card-hover animate-on-scroll slide-up" style="transition-delay: 0.4s;">
                        <div class="flex items-center justify-center h-16 w-16 rounded-full bg-brand-light mx-auto text-3xl">
                            <!-- SVG Icon for Hiệu Suất Vượt Trội (Superior Performance) - Star -->
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-white" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                            </svg>
                        </div>
                        <h3 class="mt-5 text-xl font-semibold text-brand font-heading">Hiệu Suất Vượt Trội</h3> <!-- Applied font-heading here -->
                        <p class="mt-2 text-gray-600">Màu sắc rực rỡ, lâu trôi và chất son mềm mịn. Vẻ đẹp "sạch" không có nghĩa là phải thỏa hiệp.</p>
                    </div>
                </div>

                <div class="mt-20 animate-on-scroll slide-up">
                    <div class="text-center">
                        <h3 class="text-2xl font-bold text-brand font-heading">So Sánh Trực Quan</h3> <!-- Applied font-heading here -->
                        <p class="mt-2 max-w-2xl mx-auto text-md text-gray-600">Một cái nhìn nhanh để thấy sự khác biệt mà Sắc Mộc mang lại cho bạn và cho hành tinh.</p>
                    </div>
                    <div class="mt-8 chart-container">
                        <canvas id="comparisonChart" role="img" aria-label="Biểu đồ so sánh sản phẩm Sắc Mộc với son truyền thống về thành phần, bao bì, thử nghiệm động vật, minh bạch nguồn gốc và hiệu suất."></canvas>
                    </div>
                </div>
            </div>
        </section>

        <section id="products" class="py-20 bg-brand-superlight" role="region" aria-label="Sản phẩm son môi Sắc Mộc">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center animate-on-scroll slide-up">
                    <h2 class="text-3xl font-bold text-brand font-heading">Khám Phám Màu Son Của Bạn</h2> <!-- Applied font-heading here -->
                    <p class="mt-4 max-w-3xl mx-auto text-lg text-gray-600">Tìm kiếm sắc màu hoàn hảo chưa bao giờ dễ dàng hơn. Hãy thử ngay những gam màu lấy cảm hứng từ thiên nhiên của chúng tôi.</p>
                </div>

                <!-- Product list layout adjusted for larger squares -->
                <!-- Changed to 6 columns for large screens to make squares smaller and match thu_son_ao.html -->
                <div class="mt-16 grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-6 lg:gap-8" id="product-list" role="list">
                    <!-- Product items will be dynamically inserted here by JavaScript -->
                </div>

                <div class="mt-12 text-center animate-on-scroll zoom-in">
                     <a href="thu_son_ao.html"
                        class="inline-block bg-brand text-white font-bold py-3 px-8 rounded-full shadow-lg transition-all transform hover:scale-105 hover:shadow-2xl btn-pulse"
                        aria-label="Trải Nghiệm Thử Son Ảo (Live)">
                        🎥 Trải Nghiệm Thử Son Ảo (Live)
                    </a>
                </div>
            </div>
        </section>

        <section id="transparency" class="py-20 bg-[#F5F5DC]" role="region" aria-label="Trung tâm minh bạch về thành phần sản phẩm">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center animate-on-scroll slide-up">
                    <h2 class="text-3xl font-bold text-brand font-heading">Trung Tâm Minh Bạch</h2> <!-- Applied font-heading here -->
                    <p class="mt-4 max-w-3xl mx-auto text-lg text-gray-600">Chúng tôi tin vào vẻ đẹp không che giấu. Khám phá câu chuyện đằng sau mỗi thành phần làm nên thỏi son của bạn.</p>
                </div>
                <div id="ingredient-accordion" class="mt-12 max-w-3xl mx-auto space-y-4" role="tablist" aria-orientation="vertical">
                    <!-- Ingredient accordion items will be dynamically inserted here by JavaScript -->
                </div>
            </div>
        </section>

        <section id="community" class="py-20 bg-brand-superlight" role="region" aria-label="Cộng đồng Sắc Mộc">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="text-center animate-on-scroll slide-up">
                    <h2 class="text-3xl font-bold text-brand font-heading">Cộng Đồng Sắc Mộc</h2> <!-- Applied font-heading here -->
                    <p class="mt-4 max-w-3xl mx-auto text-lg text-gray-600">Tham gia cùng hàng ngàn phụ nữ Việt đã lựa chọn vẻ đẹp có ý thức. Chia sẻ khoảnh khắc của bạn với #SacMocBeauty.</p>
                </div>
                <div class="mt-16 relative animate-on-scroll slide-up">
                    <div class="testimonial-viewport" role="group" aria-label="Lời chứng thực của khách hàng"> <!-- Wrapper for overflow and snap -->
                        <div id="testimonial-slider" role="presentation"> <!-- This now acts as the flex container for cards -->
                            <!-- Testimonial cards will be dynamically inserted here by JavaScript -->
                        </div>
                    </div>
                    <button id="prev-testimonial" class="absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-1/2 bg-white/70 hover:bg-white text-brand p-3 rounded-full shadow-md z-10" aria-label="Xem lời chứng thực trước">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-6 h-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
                        </svg>
                    </button>
                    <button id="next-testimonial" class="absolute right-0 top-1/2 transform -translate-y-1/2 translate-x-1/2 bg-white/70 hover:bg-white text-brand p-3 rounded-full shadow-md z-10" aria-label="Xem lời chứng thực tiếp theo">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-6 h-6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
                        </svg>
                    </button>
                </div>
            </div>
        </section>
    </main>

    <footer class="bg-gray-800 text-white py-12" role="contentinfo">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <h3 class="text-2xl font-bold font-heading">Sắc Mộc</h3> <!-- Applied font-heading here -->
            <p class="mt-2">Tự nhiên từ Sắc, Mộc từ tâm</p> <!-- Updated text as requested -->
            <div class="mt-6 flex justify-center space-x-6">
                <!-- Updated Facebook link to the specified URL -->
                <a href="https://www.facebook.com/profile.php?id=61576617677748" class="hover:text-brand-light" aria-label="Theo dõi chúng tôi trên Facebook" target="_blank" rel="noopener noreferrer">Facebook</a>
                <a href="#" class="hover:text-brand-light" aria-label="Theo dõi chúng tôi trên Instagram">Instagram</a>
                <a href="#" class="hover:text-brand-light" aria-label="Theo dõi chúng tôi trên Tiktok">Tiktok</a>
            </div>
            <p class="mt-6 text-sm text-gray-400">&copy; 2025 Sắc Mộc Việt Nam. All rights reserved.</p>
        </div>
    </footer>

    <!-- Shopping Cart Sidebar -->
    <div id="cart-sidebar" class="cart-sidebar">
        <div class="flex justify-between items-center p-6 border-b border-gray-200">
            <h3 class="text-2xl font-bold text-brand font-heading">Giỏ Hàng</h3>
            <button id="close-cart-sidebar" class="text-gray-500 hover:text-gray-800 focus:outline-none p-2 rounded-full hover:bg-gray-100 transition-colors" aria-label="Đóng giỏ hàng">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-6 h-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                </svg>
            </button>
        </div>
        <div id="cart-items" class="flex-grow p-6 overflow-y-auto">
            <!-- Cart items will be dynamically inserted here -->
            <p id="empty-cart-message" class="text-center text-gray-500 hidden">Giỏ hàng của bạn đang trống.</p>
        </div>
        <div class="p-6 border-t border-gray-200">
            <!-- Discount Code Section -->
            <div class="mb-4">
                <label for="discount-code" class="block text-sm font-medium text-gray-700 mb-2">Mã giảm giá:</label>
                <div class="flex space-x-2">
                    <input type="text" id="discount-code" class="flex-grow p-2 border border-gray-300 rounded-md focus:ring-brand focus:border-brand-light outline-none" placeholder="Nhập mã giảm giá">
                    <button id="apply-discount-btn" class="bg-gray-400 text-white px-4 py-2 rounded-md cursor-not-allowed" disabled>Áp dụng</button>
                </div>
                <p id="discount-message" class="text-sm mt-2"></p>
            </div>

            <div class="flex justify-between items-center text-lg font-semibold text-gray-800 mb-2">
                <span>Tạm tính:</span>
                <span id="cart-subtotal-price">0₫</span>
            </div>
            <div id="discount-display" class="flex justify-between items-center text-base text-red-600 mb-4 hidden">
                <span>Giảm giá (<span id="discount-percentage">0%</span>):</span>
                <span id="discount-amount">-0₫</span>
            </div>
            <div class="flex justify-between items-center text-lg font-semibold text-gray-800 mb-4">
                <span>Tổng cộng:</span>
                <span id="cart-total-price">0₫</span>
            </div>
            <button class="w-full bg-brand text-white font-bold py-3 px-4 rounded-lg shadow-md hover:bg-opacity-90 transition-transform transform hover:scale-105" aria-label="Tiến hành thanh toán">
                Thanh Toán
            </button>
        </div>
    </div>
    <!-- Cart Overlay -->
    <div id="cart-overlay" class="cart-overlay"></div>

    <!-- Removed VTO Modal section entirely -->

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Mobile menu toggle
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');

            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });
            
            // Smooth scroll for anchor links and close mobile menu on click
            document.querySelectorAll('#mobile-menu a, header a[href^="#"]').forEach(link => {
                link.addEventListener('click', (e) => {
                    if (link.closest('#mobile-menu')) mobileMenu.classList.add('hidden'); // Close mobile menu
                    const targetId = link.getAttribute('href');
                    if (targetId.startsWith('#')) { // Check if it's an anchor link
                        e.preventDefault();
                        document.querySelector(targetId).scrollIntoView({ behavior: 'smooth'});
                    }
                    // If it's not an anchor link (e.g., href="thu_son_ao.html"), let the default behavior happen
                });
            });

            // Intersection Observer for scroll animations
            const observerOptions = {
                root: null, // viewport
                rootMargin: '0px',
                threshold: 0.1 // Trigger when 10% of the element is visible
            };

            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        observer.unobserve(entry.target); // Stop observing once animated
                    }
                });
            }, observerOptions);

            // Observe existing static elements
            document.querySelectorAll('.animate-on-scroll').forEach(element => {
                // If element is already in viewport on load, make it visible immediately
                if (element.getBoundingClientRect().top < window.innerHeight) {
                    element.classList.add('visible');
                } else {
                    // Otherwise, observe it for when it comes into view
                    observer.observe(element);
                }
            });


            // Comparison Chart
            const comparisonChartCtx = document.getElementById('comparisonChart').getContext('2d');
            new Chart(comparisonChartCtx, {
                type: 'bar',
                data: {
                    labels: ['Thành Phần', 'Bao Bì', 'Thử Nghiệm Động Vật', 'Minh Bạch Nguồn Gốc', 'Hiệu Suất'],
                    datasets: [{
                        label: 'Son Truyền Thống',
                        data: [4, 2, 3, 2, 8], // Example scores
                        backgroundColor: '#A2B99C', // bg-brand-light
                        borderColor: '#8CA786',
                        borderWidth: 1
                    }, {
                        label: 'Sắc Mộc',
                        data: [9, 8, 10, 10, 9], // Example scores for Sac Moc
                        backgroundColor: '#5D7A4D', // bg-brand
                        borderColor: '#4D643E',
                        borderWidth: 1
                    }]
                },
                options: {
                    indexAxis: 'y', // Horizontal bar chart
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            beginAtZero: true,
                            max: 10 // Assuming scores are out of 10
                        },
                        y: {
                            ticks: {
                                font: {
                                    size: 12 // Adjust font size if needed
                                }
                            }
                        }
                    }
                }
            });

            // Products Data - Cấu trúc dữ liệu đã được cập nhật
            const products = [
                { id: 'son-do-cam', displayName: 'Đỏ Cam', fullName: 'Đỏ Cam - 01', color: '#FF4500', hexOpacity: 'FF4500B3', price: 300000 },
                { id: 'son-cam-tuoi', displayName: 'Cam Tươi', fullName: 'Cam Tươi - 02', color: '#FFA500', hexOpacity: 'FFA500B3', price: 300000 },
                { id: 'son-do-hong', displayName: 'Đỏ Hồng', fullName: 'Đỏ Hồng - 03', color: '#FF69B4', hexOpacity: 'FF69B4B3', price: 300000 },
                { id: 'son-do-cherry', displayName: 'Đỏ Cherry', fullName: 'Đỏ Cherry - 04', color: '#DC143C', hexOpacity: 'DC143CB3', price: 300000 },
                { id: 'son-hong-canh-sen', displayName: 'Hồng Cánh Sen', fullName: 'Hồng Cánh Sen - 05', color: '#FF007F', hexOpacity: 'FF007FB3', price: 300000 },
                { id: 'son-cam-dat', displayName: 'Cam Đất', fullName: 'Cam Đất - 06', color: '#CD853F', hexOpacity: 'CD853FB3', price: 300000 },
                { id: 'son-hong-cam', displayName: 'Hồng Cam', fullName: 'Hồng Cam - 07', color: '#FF7F50', hexOpacity: 'FF7F50B3', price: 300000 },
                { id: 'son-do-ruou-vang', displayName: 'Đỏ Rượu Vang', fullName: 'Đỏ Rượu Vang - 08', color: '#800020', hexOpacity: '800020B3', price: 300000 },
                { id: 'son-hong-fuchsia', displayName: 'Hồng Fuchsia', fullName: 'Hồng Fuchsia - 09', color: '#C154C1', hexOpacity: 'C154C1B3', price: 300000 },
                { id: 'son-nude-dao', displayName: 'Nude Đào', fullName: 'Nude Đào - 10', color: '#F7CAC9', hexOpacity: 'F7CAC9B3', price: 300000 },
                { id: 'son-man-chin', displayName: 'Mận Chín', fullName: 'Mận Chín - 11', color: '#8E4585', hexOpacity: '8E4585B3', price: 300000 },
                { id: 'son-hong-tim', displayName: 'Hồng Tím', fullName: 'Hồng Tím - 12', color: '#C8A2C8', hexOpacity: 'C8A2C8B3', price: 300000 } 
            ];

            // Shopping Cart Logic
            let cart = {}; // { productId: quantity }
            let appliedDiscount = { code: '', percentage: 0, amount: 0 }; // Stores applied discount information

            const discountCodes = {
                "chaobanmoi": 0.15, // 15% discount
                "sonsacmoc": 0.05   // 5% discount
            };

            const cartBadgeDesktop = document.getElementById('cart-badge-desktop');
            const cartBadgeMobile = document.getElementById('cart-badge-mobile');
            const cartIconDesktop = document.getElementById('cart-icon-desktop');
            const cartIconMobile = document.getElementById('cart-icon-mobile');
            const cartSidebar = document.getElementById('cart-sidebar');
            const cartOverlay = document.getElementById('cart-overlay');
            const closeCartSidebarBtn = document.getElementById('close-cart-sidebar');
            const cartItemsContainer = document.getElementById('cart-items');
            const cartSubtotalPriceElement = document.getElementById('cart-subtotal-price'); // New element for subtotal
            const discountDisplayElement = document.getElementById('discount-display');
            const discountPercentageElement = document.getElementById('discount-percentage');
            const discountAmountElement = document.getElementById('discount-amount');
            const cartTotalPriceElement = document.getElementById('cart-total-price');
            const emptyCartMessage = document.getElementById('empty-cart-message');
            const discountCodeInput = document.getElementById('discount-code');
            const applyDiscountBtn = document.getElementById('apply-discount-btn');
            const discountMessageElement = document.getElementById('discount-message');


            function updateCartCount() {
                let totalItems = 0;
                for (const productId in cart) {
                    totalItems += cart[productId];
                }
                if (totalItems > 0) {
                    cartBadgeDesktop.textContent = totalItems;
                    cartBadgeMobile.textContent = totalItems;
                    cartBadgeDesktop.classList.remove('hidden');
                    cartBadgeMobile.classList.remove('hidden');
                } else {
                    cartBadgeDesktop.classList.add('hidden');
                    cartBadgeMobile.classList.add('hidden');
                }
            }

            function formatCurrency(amount) {
                // Add non-breaking space for thousands separator and currency symbol
                return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(amount).replace(/\s/g, '\u00A0');
            }

            function calculateTotals() {
                let subtotal = 0;
                for (const productId in cart) {
                    const quantity = cart[productId];
                    const product = products.find(p => p.id === productId);
                    if (product) {
                        subtotal += quantity * product.price;
                    }
                }

                let total = subtotal;
                if (appliedDiscount.percentage > 0) {
                    appliedDiscount.amount = subtotal * appliedDiscount.percentage;
                    total = subtotal - appliedDiscount.amount;
                    discountDisplayElement.classList.remove('hidden');
                    discountPercentageElement.textContent = `${appliedDiscount.percentage * 100}%`;
                    discountAmountElement.textContent = `-${formatCurrency(appliedDiscount.amount)}`;
                } else {
                    discountDisplayElement.classList.add('hidden');
                    appliedDiscount.amount = 0; // Reset amount if no code is applied
                }

                cartSubtotalPriceElement.textContent = formatCurrency(subtotal);
                cartTotalPriceElement.textContent = formatCurrency(total);
                return { subtotal, total };
            }

            function renderCart() {
                cartItemsContainer.innerHTML = ''; // Clear current items
                let hasItems = false;

                for (const productId in cart) {
                    const quantity = cart[productId];
                    if (quantity > 0) {
                        hasItems = true;
                        const product = products.find(p => p.id === productId);
                        if (product) {
                            const itemTotal = quantity * product.price;

                            const cartItemDiv = document.createElement('div');
                            cartItemDiv.className = 'flex items-center justify-between py-3 border-b border-gray-200 last:border-b-0';
                            cartItemDiv.innerHTML = `
                                <div class="flex items-center space-x-4 flex-grow">
                                    <div class="w-16 h-16 rounded-lg flex-shrink-0" style="background-color: ${product.color};"></div>
                                    <div class="flex-grow">
                                        <p class="font-semibold text-gray-800 text-sm md:text-base">${product.fullName}</p>
                                        <p class="text-gray-600 text-xs md:text-sm">${formatCurrency(product.price)}</p>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2 flex-shrink-0 mx-2">
                                    <button class="cart-quantity-btn cart-decrease-btn bg-gray-200 text-gray-700 w-7 h-7 md:w-8 md:h-8 rounded-full hover:bg-gray-300 transition-colors flex items-center justify-center" data-product-id="${product.id}" aria-label="Giảm số lượng ${product.fullName}">-</button>
                                    <span class="font-semibold text-gray-800 w-5 text-center text-sm" data-product-id="${product.id}-quantity-cart">${quantity}</span>
                                    <button class="cart-quantity-btn cart-increase-btn bg-gray-200 text-gray-700 w-7 h-7 md:w-8 md:h-8 rounded-full hover:bg-gray-300 transition-colors flex items-center justify-center" data-product-id="${product.id}" aria-label="Tăng số lượng ${product.fullName}">+</button>
                                </div>
                                <span class="font-semibold text-brand text-right w-[90px] flex-shrink-0 text-sm md:text-base">${formatCurrency(itemTotal)}</span>
                            `;
                            cartItemsContainer.appendChild(cartItemDiv);
                        }
                    }
                }

                if (hasItems) {
                    emptyCartMessage.classList.add('hidden');
                } else {
                    emptyCartMessage.classList.remove('hidden');
                }

                calculateTotals();
                updateCartCount();
            }

            function addToCart(productId, animate = true) {
                cart[productId] = (cart[productId] || 0) + 1;
                renderCart();
                // Update quantity display on the product card
                const quantityDisplay = document.querySelector(`#${productId}-quantity`);
                if (quantityDisplay) {
                    quantityDisplay.textContent = cart[productId];
                }

                if (animate) {
                    triggerFlyToCartAnimation(productId);
                }
            }

            function decreaseQuantity(productId) {
                if (cart[productId] && cart[productId] > 0) {
                    cart[productId]--;
                    if (cart[productId] === 0) {
                        delete cart[productId]; // Remove if quantity is 0
                    }
                    renderCart();
                    // Update quantity display on the product card
                    const quantityDisplay = document.querySelector(`#${productId}-quantity`);
                    if (quantityDisplay) {
                        quantityDisplay.textContent = cart[productId] || 0; // Show 0 if removed
                    }
                }
            }

            // Function to trigger the fly-to-cart animation
            function triggerFlyToCartAnimation(productId) {
                const productCard = document.getElementById(productId);
                // Dynamically select the correct cart icon based on screen size
                const cartIcon = window.innerWidth >= 768 ? cartIconDesktop : cartIconMobile;

                if (!productCard || !cartIcon) return;

                const productRect = productCard.querySelector('.relative').getBoundingClientRect();
                const cartRect = cartIcon.getBoundingClientRect();

                const flyEl = document.createElement('div');
                flyEl.className = 'fly-to-cart-animation';
                flyEl.style.setProperty('--start-x', `${productRect.left + productRect.width / 2 - 20}px`); // Centered and adjusted for 40px size
                flyEl.style.setProperty('--start-y', `${productRect.top + productRect.height / 2 - 20}px`); // Centered and adjusted for 40px size
                flyEl.style.setProperty('--end-x', `${cartRect.left + cartRect.width / 2 - 10}px`); // Centered on target, adjusted for 20px size
                flyEl.style.setProperty('--end-y', `${cartRect.top + cartRect.height / 2 - 10}px`); // Centered on target, adjusted for 20px size
                flyEl.style.setProperty('--size', '40px'); // Initial size of the flying element
                
                const product = products.find(p => p.id === productId);
                flyEl.style.setProperty('--color', product ? product.color : '#5D7A4D'); // Use product color

                document.body.appendChild(flyEl);

                // Trigger animation
                requestAnimationFrame(() => {
                    flyEl.classList.add('animate');
                });

                // Remove element after animation
                flyEl.addEventListener('transitionend', () => {
                    flyEl.remove();
                });
            }


            // Event listeners for cart icons
            cartIconDesktop.addEventListener('click', () => {
                cartSidebar.classList.add('open');
                cartOverlay.classList.add('open');
            });

            cartIconMobile.addEventListener('click', () => {
                cartSidebar.classList.add('open');
                cartOverlay.classList.add('open');
            });

            // Close cart sidebar
            closeCartSidebarBtn.addEventListener('click', () => {
                cartSidebar.classList.remove('open');
                cartOverlay.classList.remove('open');
            });

            // Close cart when clicking overlay
            cartOverlay.addEventListener('click', () => {
                cartSidebar.classList.remove('open');
                cartOverlay.classList.remove('open');
            });

            // Event delegation for +/- buttons in the cart sidebar
            cartItemsContainer.addEventListener('click', (e) => {
                const target = e.target;
                if (target.classList.contains('cart-increase-btn')) {
                    const productId = target.dataset.productId;
                    addToCart(productId, false); // No animation when adding from cart sidebar
                } else if (target.classList.contains('cart-decrease-btn')) {
                    const productId = target.dataset.productId;
                    decreaseQuantity(productId);
                }
            });

            // Discount code input validation and button state
            discountCodeInput.addEventListener('input', () => {
                const code = discountCodeInput.value.toLowerCase().trim();
                if (discountCodes[code]) {
                    applyDiscountBtn.disabled = false;
                    applyDiscountBtn.classList.remove('bg-gray-400', 'cursor-not-allowed');
                    applyDiscountBtn.classList.add('bg-brand-light', 'hover:bg-brand');
                } else {
                    applyDiscountBtn.disabled = true;
                    applyDiscountBtn.classList.add('bg-gray-400', 'cursor-not-allowed');
                    applyDiscountBtn.classList.remove('bg-brand-light', 'hover:bg-brand');
                }
                // Clear discount message and reset applied discount if input changes after successful application
                if (appliedDiscount.code && code !== appliedDiscount.code) {
                    appliedDiscount.code = '';
                    appliedDiscount.percentage = 0;
                    appliedDiscount.amount = 0;
                    discountMessageElement.textContent = "";
                    calculateTotals();
                }
            });

            // Discount code application logic
            applyDiscountBtn.addEventListener('click', () => {
                const code = discountCodeInput.value.toLowerCase().trim();
                if (code === appliedDiscount.code) {
                    discountMessageElement.textContent = "Mã giảm giá đã được áp dụng.";
                    discountMessageElement.className = "text-sm mt-2 text-blue-600";
                    return;
                }

                if (discountCodes[code]) {
                    appliedDiscount.code = code;
                    appliedDiscount.percentage = discountCodes[code];
                    discountMessageElement.textContent = `Áp dụng mã giảm giá "${code}" thành công!`;
                    discountMessageElement.className = "text-sm mt-2 text-green-600";
                } else {
                    appliedDiscount.code = '';
                    appliedDiscount.percentage = 0;
                    appliedDiscount.amount = 0; // Reset amount if invalid code
                    discountMessageElement.textContent = "Mã giảm giá không hợp lệ.";
                    discountMessageElement.className = "text-sm mt-2 text-red-600";
                }
                calculateTotals(); // Recalculate totals with new discount
            });

            // Populate Product List with +/- buttons
            const productList = document.getElementById('product-list');
            productList.innerHTML = ''; // Clear existing content
            products.forEach(p => {
                const card = document.createElement('div');
                card.id = p.id; // Set ID for easy access
                card.className = 'group text-center animate-on-scroll zoom-in'; // Container for each product card, centered text
                card.innerHTML = `
                    <div class="relative w-full aspect-square rounded-lg overflow-hidden card-hover" aria-label="Sản phẩm son ${p.displayName}">
                        <div class="absolute inset-0 flex items-center justify-center" style="background-color: ${p.color};">
                            <h3 class="text-white text-2xl font-bold font-heading px-2 py-1">${p.displayName}</h3> 
                        </div>
                    </div>
                    <div class="mt-3 flex flex-col items-center"> <!-- Container for full name and small color circle, with top margin -->
                        <h4 class="font-semibold text-gray-800">${p.fullName}</h4>
                        <p class="text-brand font-bold mt-1">${formatCurrency(p.price)}</p>
                        <!-- Removed the small color circle here as requested -->
                        <!-- Quantity controls -->
                        <div class="flex items-center justify-center mt-3 space-x-2">
                            <button class="decrease-product-quantity bg-gray-200 text-gray-700 w-8 h-8 rounded-full hover:bg-gray-300 transition-colors" data-product-id="${p.id}" aria-label="Giảm số lượng ${p.fullName}">-</button>
                            <span id="${p.id}-quantity" class="font-semibold text-gray-800 w-6 text-center">0</span>
                            <button class="increase-product-quantity bg-brand-light text-white w-8 h-8 rounded-full hover:bg-brand transition-colors" data-product-id="${p.id}" aria-label="Tăng số lượng ${p.fullName}">+</button>
                        </div>
                    </div>
                `;
                productList.appendChild(card);
                // Observe dynamically added card after it's appended
                if (card.getBoundingClientRect().top < window.innerHeight) {
                    card.classList.add('visible');
                } else {
                    observer.observe(card); 
                }
            });

            // Event delegation for product quantity buttons
            productList.addEventListener('click', (e) => {
                const target = e.target;
                if (target.classList.contains('increase-product-quantity')) {
                    const productId = target.dataset.productId;
                    addToCart(productId); // Animation triggered here
                } else if (target.classList.contains('decrease-product-quantity')) {
                    const productId = target.dataset.productId;
                    decreaseQuantity(productId);
                }
            });

            // Initial render of the cart
            renderCart();


            // Ingredients Accordion Data
            const ingredientsData = [
                { name: 'Dầu Jojoba Hữu Cơ', description: 'Giàu Vitamin E, hoạt động như một chất dưỡng ẩm tự nhiên, giúp môi mềm mại và căng mọng. Nguồn gốc từ các trang trại hữu cơ bền vững.' },
                { name: 'Bơ Hạt Mỡ', description: 'Cung cấp độ ẩm sâu, làm dịu và phục hồi đôi môi khô, nứt nẻ. Được thu mua công bằng từ các hợp tác xã phụ nữ ở Tây Phi.' },
                { name: 'Sáp Candelilla', description: 'Một loại sáp thực vật thay thế cho sáp ong, tạo độ cứng và bóng cho son môi. Thu hoạch từ cây Candelilla ở sa mạc Chihuahuan.'},
                { name: 'Màu Khoáng Thiên Nhiên', description: 'Sử dụng oxit sắt và mica được khai thác có đạo đức thay cho thuốc nhuộm tổng hợp, đảm bảo màu sắc an toàn và rực rỡ.'}
            ];

            // Populate Ingredient Accordion
            const accordion = document.getElementById('ingredient-accordion');
            accordion.innerHTML = ''; // Clear existing content
            ingredientsData.forEach((ing, index) => {
                const item = document.createElement('div');
                item.className = 'border border-gray-200 rounded-lg overflow-hidden animate-on-scroll slide-up'; // Added animation class
                item.style.transitionDelay = `${index * 0.1}s`; // Stagger delay for each item
                item.innerHTML = `
                    <button class="accordion-button w-full text-left p-4 bg-brand-superlight hover:bg-brand-light transition duration-300 flex justify-between items-center" 
                            id="accordion-header-${index}" 
                            aria-expanded="false" 
                            aria-controls="accordion-content-${index}" 
                            role="tab" 
                            tabindex="0" 
                            aria-label="Thông tin chi tiết về ${ing.name}">
                        <span class="font-semibold text-brand">${ing.name}</span>
                        <span class="accordion-icon text-brand font-bold">+</span>
                    </button>
                    <div class="accordion-content hidden p-4 bg-[#F5F5DC]" 
                         id="accordion-content-${index}" 
                         role="tabpanel" 
                         aria-labelledby="accordion-header-${index}">
                        <p class="text-gray-600">${ing.description}</p>
                    </div>
                `;
                accordion.appendChild(item);
                // Observe dynamically added accordion item after it's appended
                if (item.getBoundingClientRect().top < window.innerHeight) {
                    item.classList.add('visible');
                } else {
                    observer.observe(item);
                }
            });
            
            // Accordion Functionality
            accordion.addEventListener('click', function(e) {
                const button = e.target.closest('.accordion-button');
                if (button) {
                    const content = button.nextElementSibling;
                    const icon = button.querySelector('.accordion-icon');
                    const isHidden = content.classList.contains('hidden');
                    
                    // Close all other accordions
                    document.querySelectorAll('#ingredient-accordion .accordion-content').forEach(c => {
                        c.classList.add('hidden');
                        c.setAttribute('aria-hidden', 'true');
                    });
                    document.querySelectorAll('#ingredient-accordion .accordion-button').forEach(btn => {
                        btn.setAttribute('aria-expanded', 'false');
                        btn.querySelector('.accordion-icon').textContent = '+';
                    });
                    
                    // Toggle current accordion
                    if (isHidden) {
                        content.classList.remove('hidden');
                        content.setAttribute('aria-hidden', 'false');
                        button.setAttribute('aria-expanded', 'true');
                        icon.textContent = '-';
                    } else {
                        // If it was already open and clicked, close it
                        content.classList.add('hidden');
                        content.setAttribute('aria-hidden', 'true');
                        button.setAttribute('aria-expanded', 'false');
                        icon.textContent = '+';
                    }
                }
            });

            // Testimonials Data - Added more testimonials here for a better loop experience
            const testimonials = [
                { text: "Lần đầu tiên mình tìm được một thỏi son vừa đẹp, vừa lâu trôi mà lại an tâm về thành phần. Yêu Sắc Mộc!", author: "An Nhiên, TP.HCM" },
                { text: "Mình đang mang thai nên rất kỹ tính. Sắc Mộc là cứu tinh, giúp mình vẫn xinh đẹp mà không lo ảnh hưởng đến bé.", author: "Minh Thư, Hà Nội" },
                { text: "Thích nhất là bao bì! Vừa đẹp vừa thân thiện môi trường. Một thương hiệu Việt Nam quá tự hào.", author: "Quỳnh Anh, Đà Nẵng" },
                { text: "Màu son lên chuẩn, chất son mềm mịn không gây khô môi. Sẽ ủng hộ Sắc Mộc dài dài.", author: "Ngọc Hà, Hải Phòng" },
                { text: "Tìm kiếm mãi mới được một brand son 'sạch' đúng nghĩa. Rất hài lòng với chất lượng sản phẩm.", author: "Thu Trang, Cần Thơ" },
                { text: "Từ ngày dùng Sắc Mộc, mình không còn lo lắng về chì hay hóa chất độc hại nữa. Cảm ơn thương hiệu!", author: "Phương Vy, Bình Dương" },
                { text: "Son Sắc Mộc màu lên chuẩn, mềm môi, không hề gây bết dính. Dùng hàng ngày rất tiện lợi và an toàn.", author: "Hoàng Yến, Cần Thơ" },
                { text: "Trước giờ mình luôn tìm kiếm sản phẩm thuần chay, và Sắc Mộc đã vượt xa mong đợi của mình. Chất lượng tuyệt vời!", author: "Vân Anh, Long An" },
                { text: "Thực sự bất ngờ với độ bền màu và dưỡng ẩm của son Sắc Mộc. Rất đáng để thử!", author: "Kim Chi, Khánh Hòa" },
                { text: "Bao bì thân thiện môi trường là điểm cộng lớn. Mình rất vui khi ủng hộ một thương hiệu có trách nhiệm.", author: "Thanh Mai, Bình Thuận" },
                { text: "Son lên màu tự nhiên, phù hợp để đi làm hoặc đi chơi. Rất thích sự nhẹ nhàng và an toàn của sản phẩm.", author: "Hương Giang, Đồng Nai" },
                { text: "Chất son mịn màng như bơ, không gây khô môi chút nào. Sắc Mộc là lựa chọn hoàn hảo cho những cô nàng bận rộn.", author: "Thùy Linh, Vũng Tàu" },
                { text: "Rất ấn tượng với cam kết minh bạch thành phần của Sắc Mộc. Giờ đây mình có thể yên tâm sử dụng mỗi ngày.", author: "Diệu Hoa, Nghệ An" },
                { text: "Màu sắc rất trendy và đa dạng, mình có thể tìm thấy mọi tông màu yêu thích tại Sắc Mộc.", author: "Mai Phương, Huế" },
                { text: "Mình đã giới thiệu Sắc Mộc cho tất cả bạn bè và mọi người đều rất hài lòng. Sản phẩm chất lượng cao và an toàn.", author: "Khánh Ly, Thái Bình" , image: "https://placehold.co/150x150/A2B99C/FFFFFF?text=Khánh+Ly"},
                { text: "Yêu thích sự tự nhiên và dịu nhẹ của Sắc Mộc. Không hề gây kích ứng hay nặng môi như các loại son khác.", author: "Trang Anh, Phú Thọ" , image: "https://placehold.2o/150x150/A2B99C/FFFFFF?text=Trang+Anh"},
                { text: "Son môi của Sắc Mộc có mùi thơm nhẹ nhàng, không gây khó chịu, rất phù hợp cho những ai nhạy cảm với mùi hương.", author: "Linh Chi, Vĩnh Phúc" },
                { text: "Mình rất thích cách Sắc Mộc chú trọng đến nguyên liệu tự nhiên. Son dùng an toàn mà vẫn giữ được màu sắc tươi tắn.", author: "Quỳnh Hương, Bắc Ninh" },
                { text: "Thiết kế bao bì sang trọng và tinh tế, cầm rất chắc tay. Sắc Mộc không chỉ là son mà còn là phụ kiện thời trang.", author: "Nguyệt Ánh, Thanh Hóa" },
                { text: "Chất lượng son vượt trội so với mức giá. Mình đã thử nhiều loại son tự nhiên nhưng Sắc Mộc thực sự khác biệt.", author: "Hồng Nhung, Nam Định" },
                { text: "Sắc Mộc đã thay đổi quan điểm của mình về son môi. Vừa đẹp, vừa an toàn, không còn phải lo lắng về tác động xấu nữa.", author: "Thanh Trúc, Bình Định" },
                { text: "Mình rất ấn tượng với dịch vụ chăm sóc khách hàng của Sắc Mộc. Họ rất nhiệt tình và chu đáo.", author: "Thu Thảo, Vĩnh Long" },
                { text: "Màu son lên rất tự nhiên, giúp mình tự tin hơn mỗi ngày. Sắc Mộc là lựa chọn hoàn hảo cho phong cách 'no makeup' của mình.", author: "Mỹ Linh, Tiền Giang" },
                { text: "Đây là thỏi son đầu tiên mình dùng hết. Rất yêu thích chất son và màu sắc của Sắc Mộc.", author: "Kim Ngân, Bến Tre" },
                { text: "Sản phẩm thuần chay, không thử nghiệm trên động vật là điều mình đánh giá cao nhất ở Sắc Mộc. Vẻ đẹp có trách nhiệm thực sự!", author: "Gia Hân, Đồng Tháp" },
                { text: "Chất son mềm mịn, không gây bết dính. Mình có thể dùng Sắc Mộc cả ngày mà không lo khô môi.", author: "Hải Yến, An Giang" }
            ];

            // Populate Testimonial Slider
            const testimonialSlider = document.getElementById('testimonial-slider');
            testimonialSlider.innerHTML = ''; // Clear existing content
            testimonials.forEach(t => {
                const card = document.createElement('div');
                // Added role="group" and aria-roledescription="slide" for accessibility
                card.className = 'testimonial-card p-4 md:p-6'; // Added padding for spacing
                card.innerHTML = `
                    <div class="bg-white p-6 rounded-xl shadow-sm text-center h-full flex flex-col justify-center card-hover" role="group" aria-roledescription="slide">
                        <p class="text-gray-600 italic text-lg">"${t.text}"</p>
                        <h4 class="mt-4 font-bold text-brand">- ${t.author}</h4>
                    </div>
                `;
                testimonialSlider.appendChild(card);
            });

            // Testimonial Slider Functionality
            const prevTestimonialBtn = document.getElementById('prev-testimonial');
            const nextTestimonialBtn = document.getElementById('next-testimonial');
            let currentTestimonialIndex = 0;

            function getVisibleCardsCount() {
                if (window.innerWidth >= 1024) return 3; // lg
                if (window.innerWidth >= 768) return 2; // md
                return 1; // sm and smaller
            }

            function showTestimonials() {
                if (testimonials.length === 0) {
                    testimonialSlider.style.transform = `translateX(0px)`;
                    return;
                }
                
                const visibleCards = getVisibleCardsCount();
                const viewportWidth = testimonialSlider.parentElement.offsetWidth; // Get the width of the .testimonial-viewport
                
                // Calculate the width for each individual card to fit precisely within the viewport
                const individualCardDisplayWidth = viewportWidth / visibleCards;

                // Apply calculated width to each testimonial card and ensure it doesn't shrink
                testimonialSlider.querySelectorAll('.testimonial-card').forEach(card => {
                    card.style.width = `${individualCardDisplayWidth}px`;
                    card.style.flexShrink = '0'; 
                });

                // Set the total width of the slider to accommodate all cards side-by-side
                testimonialSlider.style.width = `${testimonials.length * individualCardDisplayWidth}px`;

                // Apply the transform to slide the cards
                testimonialSlider.style.transform = `translateX(-${currentTestimonialIndex * individualCardDisplayWidth}px)`;
                
                // Buttons are always enabled for infinite loop
                prevTestimonialBtn.disabled = false;
                nextTestimonialBtn.disabled = false;
            }

            nextTestimonialBtn.addEventListener('click', () => {
                const totalCards = testimonials.length;
                const visibleCards = getVisibleCardsCount();
                // If at the end, loop back to the start
                if (currentTestimonialIndex >= totalCards - visibleCards) {
                    currentTestimonialIndex = 0;
                } else {
                    currentTestimonialIndex++;
                }
                showTestimonials();
            });
            prevTestimonialBtn.addEventListener('click', () => {
                const totalCards = testimonials.length;
                const visibleCards = getVisibleCardsCount();
                // If at the beginning, loop to the end
                if (currentTestimonialIndex === 0) {
                    currentTestimonialIndex = totalCards - visibleCards;
                    // Ensure index is not negative if totalCards is less than visibleCards
                    if (currentTestimonialIndex < 0) currentTestimonialIndex = 0;
                } else {
                    currentTestimonialIndex--;
                }
                showTestimonials();
            });
            window.addEventListener('resize', () => {
                // Reset index on resize to prevent awkward jumps if number of visible cards changes
                currentTestimonialIndex = 0;
                showTestimonials();
            });
            
            // Call showTestimonials after all DOM content is loaded and cards are rendered
            // Using a short timeout to ensure card widths are fully calculated by browser
            // Using a short timeout to ensure card widths are fully calculated by browser
            setTimeout(showTestimonials, 100);
        });
    </script>
</body>
</html>
